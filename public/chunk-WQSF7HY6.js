import{a as C,b as V,c as D,d as A,e as L,g as N}from"./chunk-GLYEPYP4.js";import{A as r,C as u,D as _,F as M,G as O,H as j,I as w,K as y,N as P,O as k,Oa as T,P as S,X as I,Z as z,aa as F,i as v,k as p,l as m,la as E,q as a,r as h,s as g,t as d,v as c,w as i,x as f,y as b,z as x}from"./chunk-BA2Q4JWY.js";function B(n,l){if(n&1){let e=b();c(0,"button",2),x("click",function(){p(e);let o=r();return m(o.abrirChat())}),i()}}function $(n,l){if(n&1&&(c(0,"div",12)(1,"div",13)(2,"p",14),u(3),i(),c(4,"p"),u(5),i(),f(6,"div",15),i()()),n&2){let e=r().$implicit,t=r(2);a(3),_(t.formatearFecha(e.fecha.toDate())),a(2),_(e.mensaje)}}function Q(n,l){if(n&1&&(c(0,"div",16)(1,"div",17)(2,"p",18),u(3),i(),f(4,"div",19),c(5,"p"),u(6),i(),f(7,"div",15),i()()),n&2){let e=r().$implicit,t=r(2);a(3),M("",t.formatearFecha(e.fecha.toDate())," | ",e.usuario,""),a(3),_(e.mensaje)}}function Z(n,l){if(n&1&&(c(0,"div"),g(1,$,7,2,"div",10)(2,Q,8,3,"div",11),i()),n&2){let e=l.$implicit,t=r(2);a(),d("ngIf",e.usuario===t.usuarioActual),a(),d("ngIf",e.usuario!==t.usuarioActual)}}function q(n,l){if(n&1){let e=b();c(0,"div",3)(1,"div",4),g(2,Z,3,2,"div",5),i(),c(3,"div",6)(4,"div",7)(5,"input",8),w("ngModelChange",function(o){p(e);let s=r();return j(s.nuevoMensaje,o)||(s.nuevoMensaje=o),m(o)}),x("keyup.enter",function(){p(e);let o=r();return m(o.enviarMensaje(o.nuevoMensaje))}),i(),c(6,"button",9),x("click",function(){p(e);let o=r();return m(o.enviarMensaje(o.nuevoMensaje))}),i()()()()}if(n&2){let e=r();a(2),d("ngForOf",e.mensajes),a(3),O("ngModel",e.nuevoMensaje)}}var te=(()=>{class n{constructor(e,t){this.authService=e,this.firestore=t,this.chat=!1,this.mensajes=[],this.nuevoMensaje="",this.usuarioActual=null,this.esInvitado=!1}ngOnInit(){this.usuarioActual=this.authService.getCurrentUser(),this.getMensajes()}abrirChat(){this.chat=!this.chat}getMensajes(){let e=C(this.firestore,"mensajes"),t=V(e,D("fecha","asc")),o=N(t,{idField:"id"});this.sub=o.subscribe(s=>{this.mensajes=s.reverse(),console.log(s)})}enviarMensaje(e){let t=C(this.firestore,"mensajes");A(t,{mensaje:e,usuario:this.usuarioActual,fecha:new Date}),this.nuevoMensaje="",this.getMensajes()}formatearFecha(e){let t={day:"2-digit",month:"2-digit"},o={hour:"2-digit",minute:"2-digit"},s=e.toLocaleDateString("es-ES",t),W=e.toLocaleTimeString("es-ES",o);return`${s} ${W}`}static{this.\u0275fac=function(t){return new(t||n)(h(T),h(L))}}static{this.\u0275cmp=v({type:n,selectors:[["app-chat"]],standalone:!0,features:[y],decls:2,vars:2,consts:[["class","btn-chat",3,"click",4,"ngIf"],["class","chat-box",4,"ngIf"],[1,"btn-chat",3,"click"],[1,"chat-box"],[1,"message-box"],[4,"ngFor","ngForOf"],[1,"input-box"],[1,"write-reply"],["type","text","placeholder","Responder...",1,"inputText",3,"ngModelChange","keyup.enter","ngModel"],[1,"send-button",3,"click"],["class","first-chat-container",4,"ngIf"],["class","second-chat-container",4,"ngIf"],[1,"first-chat-container"],[1,"first-chat"],[1,"encabezado_msj","propio"],[1,"arrow"],[1,"second-chat-container"],[1,"second-chat"],[1,"encabezado_msj","ajeno"],[1,"circle"]],template:function(t,o){t&1&&g(0,B,1,0,"button",0)(1,q,7,2,"div",1),t&2&&(d("ngIf",!o.esInvitado),a(),d("ngIf",o.chat))},dependencies:[S,P,k,E,I,z,F],styles:['*[_ngcontent-%COMP%]{padding:0;margin:0;text-decoration:none;list-style:none;box-sizing:border-box}.btn-chat[_ngcontent-%COMP%]{position:fixed;left:90%;bottom:5%;background-image:url("./media/chat-icon-4LVOBAQ5.png");background-size:contain;background-repeat:no-repeat;width:50px;height:50px;cursor:pointer;border-radius:90px;border:none}.chat-box[_ngcontent-%COMP%]{overflow-y:auto;display:flex;flex-direction:column;width:332px;height:434px;border-radius:10px;background-color:#ffffff96;padding:16px;z-index:9999999;position:fixed;border-color:#b00287;bottom:100px;right:54px;border-style:double;box-shadow:#0000001a 0 1px 6px,#0003 0 2px 24px}.message-box[_ngcontent-%COMP%]{height:316px;width:100%;padding-right:5px;overflow-y:auto;display:flex;flex-direction:column-reverse;scroll-behavior:smooth}.first-chat-container[_ngcontent-%COMP%], .second-chat-container[_ngcontent-%COMP%]{margin-bottom:14px}.first-chat-container[_ngcontent-%COMP%]   .encabezado_msj[_ngcontent-%COMP%], .second-chat-container[_ngcontent-%COMP%]   .encabezado_msj[_ngcontent-%COMP%]{display:block;margin-bottom:2px}.first-chat[_ngcontent-%COMP%]{width:250px;margin-left:auto;background-color:#fd7ddb;padding:10px;border-radius:5px;color:#fff;position:relative}.first-chat[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:15px;overflow-wrap:break-word}.second-chat-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:flex-start}.second-chat[_ngcontent-%COMP%]{width:250px;background-color:#ecf1fb;padding:12px;border-radius:10px;color:#000;position:relative}.second-chat[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:15px;overflow-wrap:break-word}.second-chat[_ngcontent-%COMP%]   .arrow[_ngcontent-%COMP%]{content:"";width:0px;height:0px;border-right:9px solid transparent;border-left:9px solid #ecf1fb;border-top:12px solid #ecf1fb;border-bottom:9px solid transparent;margin-left:40px;margin-top:-2%;display:inline-block}.input-box[_ngcontent-%COMP%]{position:absolute;font-size:12px;bottom:0;left:0;right:0;padding:0 15px 10px;border-top:1px solid lightgray;width:100%}.input-box[_ngcontent-%COMP%]   .write-reply[_ngcontent-%COMP%]{float:left}.input-box[_ngcontent-%COMP%]   .write-reply[_ngcontent-%COMP%]   input[type=text][_ngcontent-%COMP%]{border:none;outline:none;font-size:20px}.input-box[_ngcontent-%COMP%]   .send-button[_ngcontent-%COMP%]{float:right;border:none;outline:none}.input-box[_ngcontent-%COMP%]   .send-button[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{border:none;background-color:transparent;cursor:pointer;outline:none}.send-button[_ngcontent-%COMP%]{position:fixed;background-image:url("./media/send-Z2Z47SW2.png");background-size:contain;background-repeat:no-repeat;width:25px;height:22px;cursor:pointer;border:none}.encabezado_msj[_ngcontent-%COMP%]{font-size:7px;text-align:left}.encabezado_msj.propio[_ngcontent-%COMP%]{color:#fff}.encabezado_msj.ajeno[_ngcontent-%COMP%]{color:#fd7ddb}']})}}return n})();export{te as a};
