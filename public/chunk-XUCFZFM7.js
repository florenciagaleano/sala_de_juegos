import{a as C,b as V,c as A,d as D,e as L,g as N}from"./chunk-RQWUBYQQ.js";import{$ as E,B as p,Ba as T,C as h,E as M,F as O,G as j,H as P,J as w,L as y,M as k,N as S,V as I,W as z,Z as F,h as v,j as m,k as u,p as a,q as x,r as g,s as d,u as r,v as i,w as f,x as _,y as b,z as c}from"./chunk-CLWXTAWR.js";function B(n,l){if(n&1){let t=_();r(0,"button",2),b("click",function(){m(t);let o=c();return u(o.abrirChat())}),i()}}function $(n,l){if(n&1&&(r(0,"div",12)(1,"div",13)(2,"p",14),p(3),i(),r(4,"p"),p(5),i(),f(6,"div",15),i()()),n&2){let t=c().$implicit,e=c(2);a(3),h(e.formatearFecha(t.fecha.toDate())),a(2),h(t.mensaje)}}function Q(n,l){if(n&1&&(r(0,"div",16)(1,"div",17)(2,"p",18),p(3),i(),f(4,"div",19),r(5,"p"),p(6),i(),f(7,"div",15),i()()),n&2){let t=c().$implicit,e=c(2);a(3),M("",e.formatearFecha(t.fecha.toDate())," | ",t.usuario,""),a(3),h(t.mensaje)}}function Z(n,l){if(n&1&&(r(0,"div"),g(1,$,7,2,"div",10)(2,Q,8,3,"div",11),i()),n&2){let t=l.$implicit,e=c(2);a(),d("ngIf",t.usuario===e.usuarioActual),a(),d("ngIf",t.usuario!==e.usuarioActual)}}function q(n,l){if(n&1){let t=_();r(0,"div",3)(1,"div",4),g(2,Z,3,2,"div",5),i(),r(3,"div",6)(4,"div",7)(5,"input",8),P("ngModelChange",function(o){m(t);let s=c();return j(s.nuevoMensaje,o)||(s.nuevoMensaje=o),u(o)}),i(),r(6,"button",9),b("click",function(){m(t);let o=c();return u(o.enviarMensaje(o.nuevoMensaje))}),i()()()()}if(n&2){let t=c();a(2),d("ngForOf",t.mensajes),a(3),O("ngModel",t.nuevoMensaje)}}var et=(()=>{class n{constructor(t,e){this.authService=t,this.firestore=e,this.chat=!1,this.mensajes=[],this.nuevoMensaje="",this.usuarioActual=null,this.esInvitado=!1}ngOnInit(){this.usuarioActual=this.authService.getCurrentUser(),this.getMensajes(),this.usuarioActual=="invitado@gmail.com"&&(this.esInvitado=!0)}abrirChat(){this.chat=!this.chat}getMensajes(){let t=C(this.firestore,"mensajes"),e=V(t,A("fecha","asc")),o=N(e,{idField:"id"});this.sub=o.subscribe(s=>{this.mensajes=s,console.log(s)})}enviarMensaje(t){let e=C(this.firestore,"mensajes");D(e,{mensaje:t,usuario:this.usuarioActual,fecha:new Date}),this.nuevoMensaje="",this.getMensajes()}formatearFecha(t){let e={day:"2-digit",month:"2-digit"},o={hour:"2-digit",minute:"2-digit"},s=t.toLocaleDateString("es-ES",e),W=t.toLocaleTimeString("es-ES",o);return`${s} ${W}`}static{this.\u0275fac=function(e){return new(e||n)(x(T),x(L))}}static{this.\u0275cmp=v({type:n,selectors:[["app-chat"]],standalone:!0,features:[w],decls:2,vars:2,consts:[["class","btn-chat",3,"click",4,"ngIf"],["class","chat-box",4,"ngIf"],[1,"btn-chat",3,"click"],[1,"chat-box"],[1,"message-box"],[4,"ngFor","ngForOf"],[1,"input-box"],[1,"write-reply"],["type","text","placeholder","Responder...",1,"inputText",3,"ngModelChange","ngModel"],[1,"send-button",3,"click"],["class","first-chat-container",4,"ngIf"],["class","second-chat-container",4,"ngIf"],[1,"first-chat-container"],[1,"first-chat"],[1,"encabezado_msj","propio"],[1,"arrow"],[1,"second-chat-container"],[1,"second-chat"],[1,"encabezado_msj","ajeno"],[1,"circle"]],template:function(e,o){e&1&&g(0,B,1,0,"button",0)(1,q,7,2,"div",1),e&2&&(d("ngIf",!o.esInvitado),a(),d("ngIf",o.chat))},dependencies:[S,y,k,E,I,z,F],styles:['*[_ngcontent-%COMP%]{padding:0;margin:0;text-decoration:none;list-style:none;box-sizing:border-box}.btn-chat[_ngcontent-%COMP%]{position:fixed;left:90%;bottom:5%;background-image:url("./media/chat-icon-4LVOBAQ5.png");background-size:contain;background-repeat:no-repeat;width:50px;height:50px;cursor:pointer;border-radius:90px;border:none}.chat-box[_ngcontent-%COMP%]{display:flex;flex-direction:column;width:332px;height:434px;border-radius:10px;background-color:#ffffff96;padding:16px;z-index:9999999;position:fixed;border-color:#b00287;bottom:100px;right:54px;border-style:double;box-shadow:#0000001a 0 1px 6px,#0003 0 2px 24px}.message-box[_ngcontent-%COMP%]{height:316px;width:100%;padding-right:5px;overflow:auto}.first-chat-container[_ngcontent-%COMP%], .second-chat-container[_ngcontent-%COMP%]{margin-bottom:14px}.first-chat-container[_ngcontent-%COMP%]   .encabezado_msj[_ngcontent-%COMP%], .second-chat-container[_ngcontent-%COMP%]   .encabezado_msj[_ngcontent-%COMP%]{display:block;margin-bottom:2px}.first-chat[_ngcontent-%COMP%]{width:250px;margin-left:auto;background-color:#fd7ddb;padding:10px;border-radius:5px;color:#fff;position:relative}.first-chat[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:15px;overflow-wrap:break-word}.second-chat-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:flex-start}.second-chat[_ngcontent-%COMP%]{width:250px;background-color:#ecf1fb;padding:12px;border-radius:10px;color:#000;position:relative}.second-chat[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:15px;overflow-wrap:break-word}.second-chat[_ngcontent-%COMP%]   .arrow[_ngcontent-%COMP%]{content:"";width:0px;height:0px;border-right:9px solid transparent;border-left:9px solid #ecf1fb;border-top:12px solid #ecf1fb;border-bottom:9px solid transparent;margin-left:40px;margin-top:-2%;display:inline-block}.input-box[_ngcontent-%COMP%]{position:absolute;font-size:12px;bottom:0;left:0;right:0;padding:0 15px 10px;border-top:1px solid lightgray;width:100%}.input-box[_ngcontent-%COMP%]   .write-reply[_ngcontent-%COMP%]{float:left}.input-box[_ngcontent-%COMP%]   .write-reply[_ngcontent-%COMP%]   input[type=text][_ngcontent-%COMP%]{border:none;outline:none;font-size:20px}.input-box[_ngcontent-%COMP%]   .send-button[_ngcontent-%COMP%]{float:right;border:none;outline:none}.input-box[_ngcontent-%COMP%]   .send-button[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{border:none;background-color:transparent;cursor:pointer;outline:none}.send-button[_ngcontent-%COMP%]{position:fixed;background-image:url("./media/send-Z2Z47SW2.png");background-size:contain;background-repeat:no-repeat;width:25px;height:22px;cursor:pointer;border:none}.encabezado_msj[_ngcontent-%COMP%]{font-size:7px;text-align:left}.encabezado_msj.propio[_ngcontent-%COMP%]{color:#fff}.encabezado_msj.ajeno[_ngcontent-%COMP%]{color:#fd7ddb}']})}}return n})();export{et as a};
